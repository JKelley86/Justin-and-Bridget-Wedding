<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiple Google Sheets Data</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="container">
        <nav>
            <ul class="navbar-left">
                <li><a href="index.html">Home</a></li>
                <li><a href="location.html">Info</a></li>
                <li><a href="rsvp.html">RSVP</a></li>
            </ul>
            <div class="navbar-right">
                <span class="navbar-text" onclick="toggleSecretPage()">Justin & Bridget's Wedding</span>
            </div>
        </nav>  
    </div>
    <h1>Google Sheets Data</h1>

    <h2>Sheet 1 Data</h2>
    <table id="data-table-1">
        <thead>
            <tr id="table-header-1"></tr>
        </thead>
        <tbody id="table-body-1"></tbody>
    </table>

    <h2>Sheet 2 Data</h2>
    <table id="data-table-2">
        <thead>
            <tr id="table-header-2"></tr>
        </thead>
        <tbody id="table-body-2"></tbody>
    </table>

    <script>
        // Function to initialize the Google API client
        function start() {
            gapi.client.init({
                apiKey: 'AIzaSyA5jLLGajXFA-oUlV3kNMleLNKXyDUZTQA', // Replace with your API key
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
            }).then(function() {
                // Fetch data from first sheet
                return gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: '1-fKBxtivoEn6Eg5rOZxjt-BzzKIhaBTzgNrPjAs9Qxo', // Replace with your first spreadsheet ID
                    range: 'Pricing!A2:C29', // Adjust the range as needed
                }).then(function(response) {
                    var data = response.result.values;
                    populateTable(data, 'table-header-1', 'table-body-1');
                });

                // Fetch data from second sheet
                return gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: '1-fKBxtivoEn6Eg5rOZxjt-BzzKIhaBTzgNrPjAs9Qxo', // Replace with your second spreadsheet ID
                    range: 'Guest List'!A76:D140', // Adjust the range as needed
                }).then(function(response) {
                    var data = response.result.values;
                    populateTable(data, 'table-header-2', 'table-body-2');
                });
            }).catch(function(error) {
                console.log('Error: ' + error.result.error.message);
            });
        }

        // Function to populate the table with data
        function populateTable(data, headerId, bodyId) {
            const tableHeader = document.getElementById(headerId);
            const tableBody = document.getElementById(bodyId);

            // Clear previous data
            tableHeader.innerHTML = '';
            tableBody.innerHTML = '';

            // Create table headers
            const headers = data[0];
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                tableHeader.appendChild(th);
            });

            // Populate table rows
            for (let i = 1; i < data.length; i++) {
                const tr = document.createElement('tr');
                data[i].forEach(cell => {
                    const td = document.createElement('td');
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                tableBody.appendChild(tr);
            }
        }

        // Load the Google API client and initiate the process
        gapi.load('client', start);

        // Function to toggle the visibility of the secret page
        function toggleSecretPage() {
            const dataTable1 = document.getElementById('data-table-1');
            const dataTable2 = document.getElementById('data-table-2');
            const displayStyle = dataTable1.style.display === 'none' ? 'table' : 'none';
            dataTable1.style.display = displayStyle;
            dataTable2.style.display = displayStyle;
        }

        // Initially hide the secret page content
        document.addEventListener('DOMContentLoaded', () => {
            const dataTable1 = document.getElementById('data-table-1');
            const dataTable2 = document.getElementById('data-table-2');
            dataTable1.style.display = 'none';
            dataTable2.style.display = 'none';
        });
    </script>
</body>
</html>
